function null = mfilterplot(filterstruct, typeswitch, xrangevector, yrangevector, figurenumber, positionvector, infoflag);%% ---------------------------------------------% Does some plots of the freq responses, etc, of% a 'filterstructure' made by mfiltercreate% ---------------------------------------------%% Input parameters:%   filterstruct   = the 'filterstructure' made by mfiltercreate or mbutterworth, etc%   typeswitch     = what to plot:%                   'magnituderesponse' dB vs Hz%                   'phaseresponse'     degs vs Hz%                   'phaseresponse_unwrap'     degs vs Hz%                   'groupdelay'        ms vs Hz%                   'zerospoles'        %                   'impulseresponse_linear' amplitude vs ms%                   'impulseresponse_db'     20log(amp) vs ms%                   'all' (do all of those in a 6-panel plot but not the unwrapped-phase response)%   xrangevector   = min-to-max of x-axis. Defaults used if -1%   yrangevector   = min-to-max of y-axis. Defaults used if -1%   figurenumber   = what figure to plot the results in%   positionvector = where to put the figure or how big to make it. Default used if -1%   infoflag       = 0 or 1;%% Examples:% >>  f = mbutterworth(0, 1000, 20000, 8, 'lowpass', 512, 1); % >>  mfilterplot(f, 'all', -1, -1, 1, -1, 1);% >>  mfilterplot(f, 'magnituderesponse', [900 1100], [-20 5], 1, -1, 1);%%%----------------------------------------------------------------% Original version % MAA Summer 2002 (September 20th 2002)%----------------------------------------------------------------% ******************************************************************% This MATLAB software was developed by Michael A Akeroyd for % supporting research at the University of Connecticut,% the University of Sussex and the MRC Institute% of Hearing Research. It is made available% in the hope that it may prove useful. % % Any for-profit use or redistribution is prohibited. No warranty% is expressed or implied. All rights reserved.% %    Contact address:%      Dr Michael A Akeroyd,%      MRC Institute of Hearing Research%      Glasgow Royal Infirmary %      (Queen Elizabeth Building)%      16 Alexandra Parade%      Glasgow G31 2ER%      United Kingdom%%      maa@ihr.gla.ac.uk%      http://www.ihr.gla.ac.uk% ******************************************************************% remove earlier figure if its there: 'ishandle' is from the code to closeif ishandle(figurenumber) == 1   close(figurenumber); end;figure(figurenumber);% use default position if none specifiedif positionvector == -1   if strcmp(typeswitch, 'all')==1      set(gcf, 'Position',  [120, 220,  850,  450]);  end;else   set(gcf, 'Position',  positionvector);end;hold on;% do the plots ... what to do depends on what was calledif strcmp(typeswitch, 'all')==1 | strcmp(typeswitch, 'magnituderesponse') ==1   if infoflag >= 1; fprintf(' plotting mag response  ... db         vs Hz\n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,1);   end;   plot(filterstruct.resp_hzaxis, filterstruct.magresp_db);   grid on; xlabel('Freq (Hz)'); ylabel('Mag response (dB)');end;if strcmp(typeswitch, 'all')==1 | strcmp(typeswitch,  'phaseresponse') == 1   if infoflag >= 1; fprintf(' plotting phase response ... degs       vs Hz \n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,2); end;   plot(filterstruct.resp_hzaxis, filterstruct.phaseresp_degs);   grid on; xlabel('Freq (Hz)'); ylabel('Phase response (degs)');end;if strcmp(typeswitch,  'phaseresponse_unwrap') == 1   if infoflag >= 1; fprintf(' plotting unwrapped phase response ... degs       vs Hz \n'); end;   plot(filterstruct.resp_hzaxis, filterstruct.phaseresp_unwrap_degs);   grid on; xlabel('Freq (Hz)'); ylabel('Unwrapped phase response (degs)');end;if strcmp(typeswitch, 'all')==1 | strcmp(typeswitch,  'groupdelay') == 1   if infoflag >= 1; fprintf(' plotting group delay ... ms    vs Hz \n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,3); end;   plot(filterstruct.resp_hzaxis, filterstruct.grpdelay_ms);   grid on; xlabel('Freq (Hz)'); ylabel('Group delay (ms)');end;if strcmp(typeswitch, 'all')==1 | strcmp(typeswitch,  'zerospoles') == 1   if infoflag >= 1; fprintf(' plotting zeros/poles ... \n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,4); end;   zplane(filterstruct.numer, filterstruct.denom);   grid on; end;if strcmp(typeswitch, 'all')==1 | strcmp(typeswitch,  'impulseresponse_linear') == 1   if infoflag >= 1; fprintf(' plotting impulseresponse as linear ... amplitude  vs samples \n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,5); end;   hold on;   for n=1:length(filterstruct.imp)      xvalues = [filterstruct.imp_sampletimes_ms(n), filterstruct.imp_sampletimes_ms(n)];      yvalues = [0, filterstruct.imp(n)];      plot(xvalues, yvalues, '-');   end;   grid on; xlabel('Time (ms)'); ylabel('Amplitude');   hold off;end;if strcmp(typeswitch, 'all')==1 | strcmp(typeswitch,  'impulseresponse_db')== 1   if infoflag >= 1; fprintf(' plotting impulseresponse in dB ... 20log(amp) vs samples \n'); end;   if strcmp(typeswitch, 'all')==1; subplot(2,3,6); end;   warning off;   hold on;   xvalues = filterstruct.imp_sampletimes_ms;   yvalues = 20*log10(filterstruct.imp);   plot(xvalues, yvalues, '*');   warning on;   grid on; xlabel('Time (ms)'); ylabel('20log(amp)');   hold off;end;% set the axes: always use the defaults for the 'all' plot else use the specified valuesif strcmp(typeswitch, 'all')==1    ;else    if xrangevector == -1        ;    else        mxaxis(xrangevector(1), xrangevector(2));    end;    if yrangevector == -1        ;    else        myaxis(yrangevector(1), yrangevector(2));    end;end;titlestring = sprintf('%s (%s)', filterstruct.type, filterstruct.band);set(figurenumber, 'Name', titlestring);hold off;% the end!%--------------------------