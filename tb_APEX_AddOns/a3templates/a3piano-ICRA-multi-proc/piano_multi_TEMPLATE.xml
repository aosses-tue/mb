<?xml version="1.0" encoding="UTF-8"?>
<apex:apex xmlns:apex="http://med.kuleuven.be/exporl/apex/3.0.4/experiment" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1" xsi:schemaLocation="http://med.kuleuven.be/exporl/apex/3.0.4/experiment https://gilbert.med.kuleuven.be/apex/schemas/3.0.4/experiment.xsd">

<!-- 
Comparison between test1 and test2 sounds (diotically presented) embedded in a running instrument-weighted noise (IWN):
          Description: Adaptive procedure (3AFC) where the gain of a the IWN is varied (variable SNR). 
          The HWN has approximatedly the same level than the test signals, meaning that a gain of 0 represents an SNR of 0 dB. A randomly chosen 1.5-s sample is taken from the measured and simulated hummer signals. The standard is in this experiment the measured signal.

Adapted from the following APEX file: hummer-ac-4-3AFC-sim-meas-running-m-AFC.xml.apx
    % Programmed by Alejandro Osses, HTI, TU/e, the Netherlands, 2014-2016
    % Created on    : 25/03/2016
    % Last update on: 25/03/2016 
    % Last use on   : 25/03/2016 
    
    $$ProcedureID$$ = 57
    $$Piano1$$      = P5 (test)
    $$Piano2$$      = P7 (standard)
    $$rampout_len$$ = duration of the rampout length for test, standard signals and ICRA noises (only excluding pedestal noise)
    The parameter rampout_len is particularly important for sustained piano sounds
  -->

<procedure xsi:type="apex:multiProcedureType">
    <parameters>
      	<order>random</order> 
    </parameters> 
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

$$procedure$$

</procedure>
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

  <corrector xsi:type="apex:alternatives">
    <answers>
      <answer number="1" value="button1"/>
      <answer number="2" value="button2"/>
      <answer number="3" value="button3"/>      
    </answers>
  </corrector>
  <screens>
	<general>
    <repeatbutton>false</repeatbutton>
    <showpanel>true</showpanel>
    <showmenu>true</showmenu>
	  <intertrialscreen length="500">screen1</intertrialscreen>
  </general>
    
  <reinforcement>
    <progressbar>true</progressbar>
    <feedback>false</feedback>
    <showcurrent>true</showcurrent>
  </reinforcement>

	<screen id="screen1">
            <gridLayout height="3" width="1" id="main_layout">
                <gridLayout width="3" height="1" columnstretch="1,2,1" rowstretch="1" y="1">
                    <label id="label_1" x="2" y="1">
                        <text>Which interval is different?</text>
                    </label>
                </gridLayout>
                <gridLayout width="3" height="1" columnstretch="1,1,1" rowstretch="1" y="2">
                    <button id="button1" x="1" y="1">
                        <text>First</text>
                    </button>
                    <button id="button2" x="2" y="1">
                        <text>Second</text>
                    </button>
                  <button id="button3" x="3" y="1">
                    <text>Third</text>
                  </button>
                </gridLayout>
                <gridLayout width="3" height="1" rowstretch="1" columnstretch="1,2,1" y="3">                  		
               </gridLayout>
            </gridLayout>
            <buttongroup id="btgrp1">
                <button id="button1"/>
                <button id="button2"/>
              <button id="button3"/>
            </buttongroup>
            <default_answer_element>btgrp1</default_answer_element>
        </screen>
   
  </screens>

  <datablocks>
    $$datablocks$$
  </datablocks>
  
  <devices>
    <device id="wavdevice" xsi:type="apex:wavDeviceType">
      <card>default</card>
      <channels>2</channels>
      <samplerate>44100</samplerate>
    </device>
  </devices>

  <filters>
    $$filters$$
  </filters>

  <stimuli>
    $$stimuli$$
  </stimuli>
  
  <connections>
    $$connections$$
  </connections>

  <randomgenerators>
    <randomgenerator xsi:type="apex:uniform" id="randomrove_test1">
      <min>-4</min> 
      <max>4</max> 
      <type>double</type>
      <parameter>gain_rove_test1</parameter> 
    </randomgenerator>
  </randomgenerators>
  
  $$calibration$$

  <results>
    <xsltscript>apexresult.xsl</xsltscript>
    <xsltscriptparameters>
  	 <parameter name="reversals for mean">6</parameter> <!-- reversals -->
      <parameter name="showextra">randomrove_test1</parameter> <!-- <parameter name="showextra">gain</parameter> -->
    </xsltscriptparameters>

    <showresults>true</showresults>
    <saveprocessedresults>true</saveprocessedresults>
    <matlabscript>quick_staircases.m</matlabscript>
    <subject>test</subject> 
  </results>

  <interactive>
    <entry type="string" description="Subject ID" expression="/apex:apex/results[1]/subject[1]" default=""/>
  </interactive>
  
</apex:apex>
